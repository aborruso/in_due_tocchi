---
// Mobile landing page for smartphone users
import SiteFooter from '../components/SiteFooter.astro';
import LanguageSelector from '../components/LanguageSelector.astro';
import { getSeoData, OG_LOCALES, OG_IMAGE_ALT } from '../lib/seo.js';

const { meta: pageSeo, pageUrl, imageUrl } = getSeoData('mobile', Astro);
const primaryLocale = OG_LOCALES.it;
const alternateLocales = Object.entries(OG_LOCALES)
  .filter(([lang]) => lang !== 'it')
  .map(([, locale]) => locale);
---

<!DOCTYPE html>
<html lang="it" id="html-root">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={pageSeo.translations.it.description} />
  <meta name="theme-color" content="#1e293b" />
  <title id="page-title">{pageSeo.translations.it.title}</title>
  <meta property="og:type" content={pageSeo.type} />
  <meta property="og:url" content={pageUrl} />
  <meta property="og:site_name" content="ShareForge" />
  <meta property="og:image" content={imageUrl} />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:alt" content={OG_IMAGE_ALT} />
  {primaryLocale && <meta property="og:locale" content={primaryLocale} />}
  {alternateLocales.map(locale => (
    <meta property="og:locale:alternate" content={locale} key={`og-locale-${locale}`} />
  ))}
  {Object.entries(pageSeo.translations).flatMap(([lang, data]) => [
    <meta property="og:title" content={data.title} lang={lang} key={`og-title-${lang}`} />,
    <meta property="og:description" content={data.description} lang={lang} key={`og-desc-${lang}`} />
  ])}

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content={pageUrl} />
  <meta name="twitter:image" content={imageUrl} />
  <meta name="twitter:image:alt" content={OG_IMAGE_ALT} />
  {Object.entries(pageSeo.translations).flatMap(([lang, data]) => [
    <meta name="twitter:title" content={data.title} lang={lang} key={`tw-title-${lang}`} />,
    <meta name="twitter:description" content={data.description} lang={lang} key={`tw-desc-${lang}`} />
  ])}
  <link rel="manifest" href="/in_due_tocchi/manifest.webmanifest" />
  <link rel="icon" type="image/svg+xml" href="/in_due_tocchi/favicon.svg" />
</head>
<body class="bg-slate-50 text-slate-900">
  <!-- Language Selector (fixed top-right) -->
  <div class="fixed top-4 right-4 z-50">
    <LanguageSelector />
  </div>

  <!-- Hero Section -->
  <section class="bg-gradient-to-b from-slate-900 to-slate-800 text-white py-16 px-4">
    <div class="max-w-2xl mx-auto text-center">
      <div class="text-6xl mb-6">ðŸ¤–</div>
      <h1 class="text-5xl font-bold leading-tight mb-4" data-i18n-html="mobilePage.heroTitle">
        Prepara il Contesto<br />per i tuoi LLM
      </h1>
      <p class="text-xl text-slate-200 mb-8 leading-relaxed" data-i18n="mobilePage.heroSubtitle">
        Su smartphone non puoi scrivere prompt prima di inviare l'URL. Con ShareForge, crei il contesto attorno al link e lo invii al miglior LLM per il tuo obiettivo.
      </p>
      <a href="/in_due_tocchi" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-lg text-lg transition-colors" data-i18n="mobilePage.openAppCta">
        Apri ShareForge Ora â†’
      </a>
    </div>
  </section>

  <!-- Benefits Section -->
  <section class="max-w-2xl mx-auto py-16 px-4">
    <h2 class="text-3xl font-bold text-center mb-12 text-slate-900" data-i18n="mobilePage.benefitsTitle">
      PerchÃ© ShareForge?
    </h2>

    <div class="space-y-6">
      <!-- Benefit 1 -->
      <div class="flex gap-4">
        <div class="text-4xl flex-shrink-0">ðŸ’­</div>
        <div>
          <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.benefit1Title">Crea il Contesto Prima</h3>
          <p class="text-slate-700" data-i18n="mobilePage.benefit1Text">Scegli un template e circonda l'URL con contesto strutturato. CosÃ¬ l'LLM capisce cosa vuoi, senza doverlo spiegare dopo.</p>
        </div>
      </div>

      <!-- Benefit 2 -->
      <div class="flex gap-4">
        <div class="text-4xl flex-shrink-0">âš¡</div>
        <div>
          <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.benefit2Title">Subito, Offline</h3>
          <p class="text-slate-700" data-i18n="mobilePage.benefit2Text">Zero server, zero connessione. Genera il contesto istantaneamente nel tuo smartphone, ovunque tu sia.</p>
        </div>
      </div>

      <!-- Benefit 3 -->
      <div class="flex gap-4">
        <div class="text-4xl flex-shrink-0">ðŸ“‹</div>
        <div>
          <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.benefit3Title">Template = Prompt Strutturati</h3>
          <p class="text-slate-700" data-i18n="mobilePage.benefit3Text">11 template per diversi LLM use case: SEO analysis, fact-check, sintesi, thread social. Ognuno Ã¨ un prompt ottimizzato.</p>
        </div>
      </div>

      <!-- Benefit 4 -->
      <div class="flex gap-4">
        <div class="text-4xl flex-shrink-0">ðŸŽ¯</div>
        <div>
          <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.benefit4Title">Invia al Miglior LLM</h3>
          <p class="text-slate-700" data-i18n="mobilePage.benefit4Text">Condividi il contesto a ChatGPT, Claude, Gemini o altri. Scegli il modello migliore per il tuo template/obiettivo.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Demo Section -->
  <section class="bg-slate-100 py-16 px-4">
    <div class="max-w-2xl mx-auto">
      <h2 id="demo" class="text-3xl font-bold text-center mb-12 text-slate-900" data-i18n="mobilePage.demoTitle">
        Il Flusso: URL â†’ Contesto â†’ LLM â†’ Utente
      </h2>

      <!-- Demo Video -->
      <div class="mx-auto max-w-sm">
        <div class="bg-white rounded-xl border-2 border-slate-300 overflow-hidden max-h-[500px]">
          <video
            id="demo-video"
            poster="/in_due_tocchi/video/uso-poster.jpg"
            controls
            preload="metadata"
            loading="lazy"
            class="w-full h-full object-contain"
            aria-label="Video dimostrativo: come usare ShareForge per condividere URL con template"
          >
            <source src="/in_due_tocchi/video/uso.webm" type="video/webm">
            <source src="/in_due_tocchi/video/uso.mp4" type="video/mp4">
            <p class="p-8 text-center text-slate-600">
              Il tuo browser non supporta la riproduzione video.
              <a href="/in_due_tocchi" class="text-blue-600 underline">Apri ShareForge</a> per iniziare.
            </p>
          </video>
        </div>
        <button
          id="demo-fullscreen-btn"
          class="mt-3 w-full bg-slate-900 hover:bg-slate-800 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
          aria-label="Visualizza a schermo intero"
        >
          â›¶ Fullscreen
        </button>
      </div>
      <p class="text-center text-slate-600 mt-4 text-sm" data-i18n="mobilePage.demoDescription">
        Mostra come: condividere URL â†’ scegliere template â†’ inviare a un LLM
      </p>

      <!-- Step-by-step flow explanation -->
      <div class="mt-12 max-w-xl mx-auto">
        <h3 class="text-2xl font-bold text-slate-900 mb-6 text-center" data-i18n="mobilePage.flowTitle">
          Come funziona (6 passi)
        </h3>

        <ol class="space-y-4">
          <li class="flex items-start gap-3">
            <span class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">1</span>
            <p class="text-slate-700 pt-1" data-i18n="mobilePage.flow1">Apri un contenuto (articolo, video, post...)</p>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">2</span>
            <p class="text-slate-700 pt-1" data-i18n="mobilePage.flow2">Fai click su Share</p>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">3</span>
            <p class="text-slate-700 pt-1" data-i18n="mobilePage.flow3">Condividilo con ShareForge</p>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">4</span>
            <p class="text-slate-700 pt-1" data-i18n="mobilePage.flow4">Sull'app, scegli cosa vuoi fare con quella sorgente (template)</p>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">5</span>
            <p class="text-slate-700 pt-1" data-i18n="mobilePage.flow5">Fai click su Condividi</p>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">6</span>
            <p class="text-slate-700 pt-1" data-i18n="mobilePage.flow6">Invialo al tuo sistema LLM preferito</p>
          </li>
        </ol>
      </div>
    </div>
  </section>

  <!-- PWA Installation Guide -->
  <section class="max-w-2xl mx-auto py-16 px-4">
    <h2 id="install" class="text-3xl font-bold text-center mb-4 text-slate-900" data-i18n="mobilePage.installTitle">
      Installa come App
    </h2>
    <p class="text-center text-slate-600 mb-12" data-i18n-html="mobilePage.installSubtitle">
      Aggiungi ShareForge alla schermata iniziale in 30 secondi
    </p>

    <div class="space-y-8">
      <!-- Step 1 -->
      <div class="border-l-4 border-blue-600 pl-6 py-4">
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
            1
          </div>
          <div>
            <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.step1Title">Apri Chrome</h3>
            <p class="text-slate-700 mb-3" data-i18n="mobilePage.step1Text">
              Accedi a ShareForge tramite il browser Chrome del tuo Android
            </p>
            <div class="bg-slate-100 rounded-lg p-4 border border-slate-300">
              <p class="text-sm text-slate-600 font-mono">
                https://aborruso.github.io/in_due_tocchi/
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 2 -->
      <div class="border-l-4 border-blue-600 pl-6 py-4">
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
            2
          </div>
          <div>
            <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.step2Title">Tap Menu (â‹®)</h3>
            <p class="text-slate-700 mb-3" data-i18n="mobilePage.step2Text">
              Premi i tre puntini in alto a destra del browser
            </p>
            <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
              <p class="text-sm text-slate-700" data-i18n-html="mobilePage.step2Note">
                Vedrai il bottone <strong>"Installa app"</strong> o <strong>"Aggiungi a Home"</strong>
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="border-l-4 border-blue-600 pl-6 py-4">
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
            3
          </div>
          <div>
            <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.step3Title">Tap "Installa app"</h3>
            <p class="text-slate-700 mb-3" data-i18n="mobilePage.step3Text">
              Seleziona l'opzione per aggiungere l'app alla schermata iniziale
            </p>
            <div class="bg-slate-100 rounded-lg p-4 border border-slate-300">
              <p class="text-sm text-slate-600" data-i18n="mobilePage.step3Note">
                Confermando, ShareForge apparirÃ  come app nativa sul tuo telefono
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 4 -->
      <div class="border-l-4 border-blue-600 pl-6 py-4">
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
            4
          </div>
          <div>
            <h3 class="text-xl font-bold text-slate-900 mb-2" data-i18n="mobilePage.step4Title">Goditi l'app</h3>
            <p class="text-slate-700" data-i18n="mobilePage.step4Text">
              Ora puoi usarla offline, direttamente dalla tua schermata iniziale. Nessun browser necessario.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Installation Video -->
    <div class="mt-12">
      <div class="border-l-4 border-blue-600 pl-6">
        <h3 class="text-xl font-bold text-slate-900 mb-4" data-i18n="mobilePage.installVideoTitle">Video guida all'installazione</h3>
        <div class="mx-auto max-w-sm">
          <div class="bg-white rounded-xl border-2 border-blue-200 overflow-hidden max-h-[500px]">
            <video
              id="install-video"
              poster="/in_due_tocchi/video/install-poster.jpg"
              controls
              preload="metadata"
              loading="lazy"
              class="w-full h-full object-contain"
              aria-label="Video guida: come installare ShareForge come PWA su Android"
            >
              <source src="/in_due_tocchi/video/install.webm" type="video/webm">
              <source src="/in_due_tocchi/video/install.mp4" type="video/mp4">
              <p class="p-8 text-center text-slate-600">
                Il tuo browser non supporta la riproduzione video. Segui i passaggi sopra per installare l'app.
              </p>
            </video>
          </div>
          <button
            id="install-fullscreen-btn"
            class="mt-3 w-full bg-slate-900 hover:bg-slate-800 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
            aria-label="Visualizza a schermo intero"
          >
            â›¶ Fullscreen
          </button>
        </div>
        <p class="text-slate-600 mt-3 text-sm" data-i18n="mobilePage.installVideoDescription">
          Il video mostra i passaggi per installare ShareForge su Android Chrome.
        </p>
      </div>
    </div>

    <!-- Info Box -->
    <div class="mt-12 bg-blue-50 border border-blue-300 rounded-lg p-6">
      <h3 class="font-bold text-slate-900 mb-3 flex items-center gap-2">
        <span>ðŸ’¡</span> <span data-i18n="mobilePage.installTip">Consiglio</span>
      </h3>
      <p class="text-slate-700" data-i18n-html="mobilePage.installTipText">
        Se vedi il messaggio <strong>"Pagina web non disponibile offline"</strong> la prima volta, non ti preoccupare. ShareForge caricherÃ  i dati la volta successiva. L'offline mode migliora nel tempo.
      </p>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-slate-900 text-white py-16 px-4">
    <div class="max-w-2xl mx-auto text-center">
      <h2 class="text-3xl font-bold mb-4" data-i18n="mobilePage.ctaTitle">Pronto a preparare il contesto?</h2>
      <p class="text-slate-300 mb-8 text-lg" data-i18n="mobilePage.ctaSubtitle">
        Apri ShareForge, scegli un template, e invia il contesto strutturato al tuo LLM preferito
      </p>
      <a href="/in_due_tocchi" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-lg text-lg transition-colors" data-i18n="mobilePage.openAppCta">
        Apri ShareForge Ora â†’
      </a>
    </div>
  </section>

  <div class="bg-slate-900">
    <div class="max-w-2xl mx-auto py-8 px-4">
      <SiteFooter variant="solid" />
    </div>
  </div>

  <script>
    import {
      detectLanguage,
      getCurrentLanguage,
      setLanguage,
      setTranslations,
      t
    } from '../lib/i18n.js';

    import { translations } from '../lib/translations.js';

    // Initialize i18n
    setTranslations(translations);

    // Function to update all i18n elements
    function updateI18n() {
      const lang = getCurrentLanguage();

      // Update html lang attribute
      const htmlRoot = document.getElementById('html-root');
      if (htmlRoot) {
        htmlRoot.setAttribute('lang', lang);
      }

      // Update all elements with data-i18n attribute
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = t(key);
      });

      // Update all elements with data-i18n-html attribute (for HTML content)
      // SECURITY NOTE: innerHTML is used here with translation strings.
      // This is safe because translations are bundled at build time from trusted sources (translations.js).
      // NEVER use this pattern with user-generated content or runtime-loaded strings.
      document.querySelectorAll('[data-i18n-html]').forEach(el => {
        const key = el.getAttribute('data-i18n-html');
        el.innerHTML = t(key);
      });

      // Update language selector active state
      updateLanguageSelectorState();
    }

    // Function to update language selector button states
    function updateLanguageSelectorState() {
      const lang = getCurrentLanguage();
      document.querySelectorAll('.lang-btn').forEach(btn => {
        if (btn.getAttribute('data-lang') === lang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
    }

    // Language selector event listener
    document.addEventListener('click', (e) => {
      const langBtn = e.target.closest('.lang-btn');
      if (langBtn) {
        const newLang = langBtn.getAttribute('data-lang');
        setLanguage(newLang);
        updateI18n();
      }
    });

    // Initialize on load
    updateI18n();

    // Fullscreen functionality for videos
    function setupFullscreen(videoId, btnId) {
      const video = document.getElementById(videoId);
      const btn = document.getElementById(btnId);

      if (!video || !btn) return;

      btn.addEventListener('click', () => {
        if (video.requestFullscreen) {
          video.requestFullscreen();
        } else if (video.webkitRequestFullscreen) {
          video.webkitRequestFullscreen();
        } else if (video.mozRequestFullScreen) {
          video.mozRequestFullScreen();
        } else if (video.msRequestFullscreen) {
          video.msRequestFullscreen();
        }
      });
    }

    // Setup fullscreen for both videos
    setupFullscreen('demo-video', 'demo-fullscreen-btn');
    setupFullscreen('install-video', 'install-fullscreen-btn');
  </script>

  <style is:global>
    * {
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    a {
      color: inherit;
      text-decoration: none;
    }
  </style>
</body>
</html>
